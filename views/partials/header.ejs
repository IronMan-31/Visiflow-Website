<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= title %></title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              "river-blue": "#3b82f6",
              "river-light": "#60a5fa",
              "river-dark": "#1d4ed8",
              "dark-bg": "#0f172a",
              "dark-surface": "#1e293b",
              "dark-card": "#334155",
            },
          },
        },
      };
    </script>
    <style>
      .header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 1000;
        background: rgba(0, 0, 0, 0.2);
        backdrop-filter: blur(12px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .header-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem 2rem;
        max-width: 1200px;
        margin: 0 auto;
      }

      .logo {
        font-size: 1.5rem;
        font-weight: 800;
        text-decoration: none;
        color: #3b82f6;
      }

      .nav {
        display: flex;
        gap: 2rem;
      }

      .nav-link {
        text-decoration: none;
        color: #3b82f6;
        font-weight: 500;
        transition: color 0.3s ease;
      }

      .nav-link:hover {
        color: #60a5fa;
      }

      .cta-button {
        background: black;
        color: white;
        padding: 0.75rem 1.5rem;
        border: none;
        border-radius: 0.5rem;
        font-weight: 600;
        cursor: pointer;
        transition: background 0.3s ease;
      }

      .cta-button:hover {
        background: #2563eb;
      }
    </style>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
  </head>

  <body class="dark bg-dark-bg text-gray-100 min-h-screen">
    <!-- Navigation -->
    <nav class="bg-dark-surface shadow-lg border-b border-gray-700">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <header class="header">
          <div class="header-container">
            <a href="/" class="logo" style="color: white">VLSIFLOW</a>
            <nav class="nav">
              <a href="/about" class="nav-link" style="color: white"
                >About Us</a
              >
              <a href="/dashboard" class="nav-link" style="color: white"
                >Real-Time Data
              </a>
              <a href="/addmachine" class="nav-link" style="color: white"
                >Add Machine</a
              >
              <a href="/view_machine" class="nav-link" style="color: white"
                >View Machines</a
              >
            </nav>
            <button class="cta-button">Let's Talk</button>
          </div>
        </header>
      </div>

      <!-- Mobile menu -->
      <div
        id="mobileMenu"
        class="md:hidden hidden bg-dark-surface border-t border-gray-700"
      >
        <div class="px-2 pt-2 pb-3 space-y-1">
          <% if (user) { %>
          <a
            href="/dashboard"
            class="block text-gray-300 hover:text-river-blue px-3 py-2"
            >Dashboard</a
          >
          <span class="block text-gray-300 px-3 py-2"
            >Welcome, <%= user.firstName %>!</span
          >
          <form action="/auth/logout" method="POST" class="px-3 py-2">
            <button
              type="submit"
              class="bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 w-full"
            >
              Logout
            </button>
          </form>
          <% } else { %>
          <a
            href="/login"
            class="block text-gray-300 hover:text-river-blue px-3 py-2"
            >Login</a
          >
          <a
            href="/signup"
            class="block bg-river-blue text-white px-3 py-2 rounded-md hover:bg-river-dark"
            >Sign Up</a
          >
          <% } %>
        </div>
      </div>
    </nav>

    <!-- Flash Messages -->
    <% if (error && error.length > 0) { %>
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-4">
      <% error.forEach(function(message) { %>
      <div
        class="bg-red-900/50 border border-red-700 text-red-300 px-4 py-3 rounded mb-4"
        role="alert"
      >
        <i class="fas fa-exclamation-triangle mr-2"></i>
        <%= message %>
      </div>
      <% }); %>
    </div>
    <% } %> <% if (success && success.length > 0) { %>
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-4">
      <% success.forEach(function(message) { %>
      <div
        class="bg-green-900/50 border border-green-700 text-green-300 px-4 py-3 rounded mb-4"
        role="alert"
      >
        <i class="fas fa-check-circle mr-2"></i>
        <%= message %>
      </div>
      <% }); %>
    </div>
    <% } %>

    <script>
      function toggleMobileMenu() {
        const menu = document.getElementById("mobileMenu");
        menu.classList.toggle("hidden");
      }
      async function username() {
        console.log("username called");
        let username = await fetch("/user_detail");
        username = await username.json();
        username = username.firstName;
        if (username != undefined)
          document.querySelector(
            ".cta-button"
          ).textContent = `Hey! ${username}`;
      }
      window.addEventListener("DOMContentLoaded", username);
    </script>
  </body>
</html>
